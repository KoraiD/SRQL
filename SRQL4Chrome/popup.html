<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
   <HEAD>
      <TITLE>SRQL query builder</TITLE>
      <script src="rollbar.js"></script>
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"> 
      <script src="https://unpkg.com/interactjs/dist/interact.min.js" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="styles.css">
    </HEAD>
   <BODY>
       <script>
        Rollbar.info("Query builder inicialized");
        </script>
        <script>
        // target elements with the "draggable" class
      interact('.draggable')
        .draggable({
          // enable inertial throwing
          inertia: true,
          // keep the element within the area of it's parent
          modifiers: [
            interact.modifiers.restrictRect({
              restriction: 'parent',
              endOnly: true
            })
          ],
          // enable autoScroll
          autoScroll: true,

          listeners: {
            // call this function on every dragmove event
            move: dragMoveListener,

            // call this function on every dragend event
            end (event) {
              var textEl = event.target.querySelector('p')

              textEl && (textEl.textContent =
                'moved a distance of ' +
                (Math.sqrt(Math.pow(event.pageX - event.x0, 2) +
                          Math.pow(event.pageY - event.y0, 2) | 0))
                  .toFixed(2) + 'px')
            }
          }
        })
        function dragMoveListener (event) {
        var target = event.target
        // keep the dragged position in the data-x/data-y attributes
        var x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx
        var y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy

        // translate the element
        target.style.webkitTransform =
          target.style.transform =
            'translate(' + x + 'px, ' + y + 'px)'

        // update the posiion attributes
        target.setAttribute('data-x', x)
        target.setAttribute('data-y', y)
      }

      // this function is used later in the resizing and gesture demos
      window.dragMoveListener = dragMoveListener

      /* The dragging code for '.draggable' from the demo above
      * applies to this demo as well so it doesn't have to be repeated. */

      // enable draggables to be dropped into this
      interact('.dropzone').dropzone({
        // only accept elements matching this CSS selector
        accept: '#yes-drop',
        // Require a 75% element overlap for a drop to be possible
        overlap: 0.75,

        // listen for drop related events:

        ondropactivate: function (event) {
          // add active dropzone feedback
          event.target.classList.add('drop-active')
        },
        ondragenter: function (event) {
          var draggableElement = event.relatedTarget
          var dropzoneElement = event.target

          // feedback the possibility of a drop
          dropzoneElement.classList.add('drop-target')
          draggableElement.classList.add('can-drop')
          draggableElement.textContent = 'Dragged in'
        },
        ondragleave: function (event) {
          // remove the drop feedback style
          event.target.classList.remove('drop-target')
          event.relatedTarget.classList.remove('can-drop')
          event.relatedTarget.textContent = 'Dragged out'
        },
        ondrop: function (event) {
          event.relatedTarget.textContent = 'Dropped'
        },
        ondropdeactivate: function (event) {
          // remove active dropzone feedback
          event.target.classList.remove('drop-active')
          event.target.classList.remove('drop-target')
        }
      })

      interact('.drag-drop')
        .draggable({
          inertia: true,
          modifiers: [
            interact.modifiers.restrictRect({
              restriction: 'parent',
              endOnly: true
            })
          ],
          autoScroll: true,
          // dragMoveListener from the dragging demo above
          listeners: { move: dragMoveListener }
        })

        </script>

      <div id="no-drop" class="drag-drop"> #no-drop </div>

      <div id="yes-drop" class="drag-drop"> #yes-drop </div>

      <div id="outer-dropzone" class="dropzone">
        #outer-dropzone
        <div id="inner-dropzone" class="dropzone">#inner-dropzone</div>
      </div>

   </BODY>
</HTML>
